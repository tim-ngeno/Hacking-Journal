## Post-Exploitation
### John The Ripper

This is a password security auditing and password recovery tool that can also be used for brute force cracking.

We can keep track of cracked credentials in Metasploit using the `creds` command:
```bash
msf6> workspace 178-metasploitable2

msf6> creds add user:msfadmin password:XXXXXX address:xx.xx.xx.xx port:22 protocol:tcp service-name:ssh
```

To search these later, we can find them by either host or service
```bash
creds -s ssh
creds xx.xx.xx.xx
```

### Post-Exploit Activities
Here we can perform tasks like creating a user account for your own use, or scan the network for other hosts that may be investigated next (enumeration):

#### Operating System
we can find out the distribution and version used
```bash
cat /etc/issue
cat /etc/*-release
cat /etc/lsb-release
cat /etc/redhat-release
```

Kernel version?
```bash
 cat /proc/version
 uname -a
 uname -mrs
 rpm -q kernel
 dmesg | grep Linux
```

What can we learn from the environment variables?
```bash
env
set
cat /etc/profile
cat /etc/bashrc
cat ~/.bash_profile
cat ~/.bashrc
cat ~/.bash_logout
cat ~/.zshrc
```

Applications and services
We can look at running services:
```bash
ps aux
ps -elf
top/htop
cat /etc/service
```

Which service(s) are running as root? Of these services, which are vulnerable?

```bash
 ps aux | grep root
 ps -elf | grep root
```

What applications are installed? What versions are they running?
```bash
dpkg -l
dpkg -l <PACKAGE>

rpm -qa
```

Are there scheduled jobs?
```bash
 crontab -l
 cat /etc/cron*
 cat /etc/cron.d/*
 cat /etc/cron.daily/*
 cat /etc/cron.hourly/*
 cat /etc/cron.monthly/*
 cat /etc/crontab
 cat /etc/at.allow
 cat /etc/at.deny
 cat /etc/anacrontab
```

### Communication Networks
What NICs does the system have? Connected networks?
```bash
ifconfig
ip link
ip addr
/sbin/ifconfig -a
cat /etc/network/interfaces
cat /etc/sysconfig/network
```
Here we can also look at the net configuration settings: DNS server, DHCP server,Firewall rules
```bash
cat /etc/resolv.conf
cat /etc/sysconfig/network
cat /etc/networks
(sudo)iptables -L
hostname
dnsdomainname
```

Check other users and hosts communicating with this system
```bash
lsof -i
lsof -i :80
netstat -antup/antpx/tulpn
chkconfig --list
chkconfig --list | grep 3:on
last
w
```

### Confidential information and users
Logged in users, previously logged in users, access and permissions
```bash
id
who
w
last
cat /etc/passwd
cat /etc/sudoers
sudo -l
```

Sensitive files
```bash
cat /etc/passwd
cat /etc/group
cat /etc/shadow
```

Passwords in plaintext?
```bash
cat ~/.bash_history
cat ~/.zsh_history
cat ~/.nano_history
cat ~/.atftp_history
cat ~/.mysql_history
cat ~/.php_history
```

Private keys
```bash
cat ~/.ssh
```

- We can pivot from the victim machine to do network scans on other hosts active within a specific subnet
```bash
for i in {1..254}; do
    ping -c 1 -W 1 192.168.1.$i | grep "from" &
done; wait
```
